<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SVG Test</title>
    <style>
        #mySvg {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
<svg id="mySvg"></svg>
<script>
    const mySvg = document.querySelector("#mySvg");


    class SgBaseItem {
        id;
        x;
        y;


        constructor({id, x, y}) {
            this.id = id;
            this.x = x;
            this.y = y;
        }

        moveTo(thing, x, y) {}

        get obj() {}
    }

    class SgLine extends SgBaseItem {
        endX;
        endY;
        lineObj;

        constructor({id, x, y}) {
            super({id, x, y});
            this.lineObj = document.createElementNS("http://www.w3.org/2000/svg", "line");
            this.lineObj.setAttribute("id", this.id);
            this.lineObj.setAttribute("x1", this.x);
            this.lineObj.setAttribute("y1", this.y);
            this.lineObj.setAttribute("stroke", "black");
            this.lineObj.addEventListener("click", (e) => {
                console.log(`click: ${this.id}`);
            });
        }

        moveTo(thing, x, y) {
            if (!thing || thing === 'end') {
                this.endX = x;
                this.endY = y;
                this.lineObj.setAttribute("x2", this.endX);
                this.lineObj.setAttribute("y2", this.endY);
            }
        }

        get obj() {
            return this.lineObj;
        }

    }


    let lineId = 0;
    let currentObj = null;
    let mousePressed = false;


    const startPoint = {x: 0, y: 0};
    mySvg.addEventListener("mousedown", (e) => {
        mousePressed = true;
        startPoint.x = e.offsetX;
        startPoint.y = e.offsetY;
    });

    mySvg.addEventListener("mouseup", (e) => {
        mousePressed = false;
        lineId++;
        currentObj = null;
    });

    mySvg.addEventListener("mousemove", (e) => {
        if (mousePressed) {
            if (!currentObj) {
                currentObj = new SgLine({id: lineId, x: startPoint.x, y: startPoint.y})
                mySvg.appendChild(currentObj.obj);
            }
            currentObj.moveTo('', e.offsetX, e.offsetY)
        }
    });

</script>
</body>
</html>